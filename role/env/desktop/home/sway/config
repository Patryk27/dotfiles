set $mod Mod4
floating_modifier $mod
popup_during_fullscreen smart
workspace_layout tabbed

## ----- ##
## theme ##

font pango:Iosevka Custom 10
title_align center
titlebar_padding 1 1

client.background       #282828
client.focused          #282828 #282828 #b8bb26 #282828 #282828
client.unfocused        #282828 #282828 #dfdfdf #282828 #282828
client.focused_inactive #282828 #282828 #dfdfdf #282828 #282828
client.urgent           #282828 #dc3545 #ffffff #282828 #282828
client.placeholder      #282828 #282828 #dfdfdf #282828 #282828

## ------ ##
## inputs ##

input "1:1:AT_Translated_Set_2_keyboard" {
    xkb_layout "custom"
    xkb_options caps:escape,compose:prsc
    repeat_delay 200
    repeat_rate 25
}

input "12951:18804:ZSA_Technology_Labs_ErgoDox_EZ" {
    xkb_layout "pl"
    xkb_options compose:prsc
    repeat_delay 200
    repeat_rate 25
}

input type:mouse {
    scroll_factor 0.6
}

## ---- ##
## main ##

seat * hide_cursor 2000

bindsym Super_L mode "~"
bindsym Print mode "~"

bindsym XF86AudioRaiseVolume exec pactl set-sink-volume @DEFAULT_SINK@ +5%
bindsym XF86AudioLowerVolume exec pactl set-sink-volume @DEFAULT_SINK@ -5%
bindsym XF86AudioMute exec pactl set-sink-mute @DEFAULT_SINK@ toggle
bindsym XF86AudioMicMute exec pactl set-source-mute @DEFAULT_SOURCE@ toggle
bindsym XF86MonBrightnessDown exec brightnessctl set 5%-
bindsym XF86MonBrightnessUp exec brightnessctl set +5%

mode "~" {
    bindsym Super_L mode "default"

    bindsym q workspace 1; mode "default"
    bindsym w workspace 2; mode "default"
    bindsym e workspace 3; mode "default"
    bindsym a workspace 4; mode "default"
    bindsym s workspace 5; mode "default"
    bindsym d workspace 6; mode "default"
    bindsym z workspace 7; mode "default"
    bindsym x workspace 8; mode "default"
    bindsym c workspace 9; mode "default"

    bindsym h focus left; mode "default"
    bindsym j focus down; mode "default"
    bindsym k focus up; mode "default"
    bindsym l focus right; mode "default"
    bindsym y focus parent; mode "default"
    bindsym n focus child; mode "default"

    bindsym Shift+h move left; mode "default"
    bindsym Shift+j move down; mode "default"
    bindsym Shift+k move up; mode "default"
    bindsym Shift+l move right; mode "default"

    bindsym Backspace mode "~/system"
    bindsym u mode "~/screen"
    bindsym i mode "~/workspace"
    bindsym o mode "~/container"
    bindsym p mode "~/window"

    bindsym Return exec "wofi --show drun"; mode "default"
    bindsym Space exec "kitty"; mode "default"
}

mode "~/container" {
    bindsym Super_L mode "default"

    bindsym h split h; mode "default"
    bindsym j split v; mode "default"

    bindsym r layout tabbed; mode "default"
    bindsym f layout stacking; mode "default"
    bindsym v layout toggle split; mode "default"

    bindsym Shift+h move container left; mode "default"
    bindsym Shift+j move container down; mode "default"
    bindsym Shift+k move container up; mode "default"
    bindsym Shift+l move container right; mode "default"

    bindsym Shift+q move container to workspace 1; mode "default"
    bindsym Shift+w move container to workspace 2; mode "default"
    bindsym Shift+e move container to workspace 3; mode "default"
    bindsym Shift+a move container to workspace 4; mode "default"
    bindsym Shift+s move container to workspace 5; mode "default"
    bindsym Shift+d move container to workspace 6; mode "default"
    bindsym Shift+z move container to workspace 7; mode "default"
    bindsym Shift+x move container to workspace 8; mode "default"
    bindsym Shift+c move container to workspace 9; mode "default"

    bindsym Ctrl+Shift+h move container to output left; mode "default"
    bindsym Ctrl+Shift+j move container to output down; mode "default"
    bindsym Ctrl+Shift+k move container to output up; mode "default"
    bindsym Ctrl+Shift+l move container to output right; mode "default"
}

mode "~/screen" {
    bindsym Super_L mode "default"

    bindsym o exec bash -c 'geo="$(slurp)"; sleep 1; grim -g "$geo" -t png - | wl-copy -t image/png'; mode "default"
    bindsym p exec grim -g "$(slurp)" -t png - | wl-copy -t image/png; mode "default"
    bindsym Shift+p exec grim -g "$(slurp)" -t png /tmp/screen.png; mode "default"

    bindsym r exec \
        dbus-send /io/pwy/ScreenRecorder io.pwy.ScreenRecorder.Started \
     && wf-recorder -g "$(slurp)" -f /tmp/screen.mp4 \
      ; mode "default"

    bindsym Shift+R exec \
        dbus-send /io/pwy/ScreenRecorder io.pwy.ScreenRecorder.Stopped \
     && pkill -SIGINT wf-recorder \
      ; mode "default"
}

mode "~/system" {
    bindsym Super_L mode "default"

    bindsym d exec "makoctl set-mode dnd"; mode "default"
    bindsym Shift+d exec "makoctl set-mode default"; mode "default"

    bindsym l exec "swaylock -c 000000 -d && swaymsg mode default"
    bindsym p exec "poweroff"
    bindsym r exec "reboot"
}

mode "~/window" {
    bindsym Super_L mode "default"

    bindsym f floating toggle; mode "default"
    bindsym g fullscreen toggle; mode "default"
    bindsym q kill; mode "default"

    bindsym Shift+q move window to workspace 1; mode "default"
    bindsym Shift+w move window to workspace 2; mode "default"
    bindsym Shift+e move window to workspace 3; mode "default"
    bindsym Shift+a move window to workspace 4; mode "default"
    bindsym Shift+s move window to workspace 5; mode "default"
    bindsym Shift+d move window to workspace 6; mode "default"
    bindsym Shift+z move window to workspace 7; mode "default"
    bindsym Shift+x move window to workspace 8; mode "default"
    bindsym Shift+c move window to workspace 9; mode "default"

    bindsym Ctrl+Shift+h move window to output left; mode "default"
    bindsym Ctrl+Shift+j move window to output down; mode "default"
    bindsym Ctrl+Shift+k move window to output up; mode "default"
    bindsym Ctrl+Shift+l move window to output right; mode "default"
}

mode "~/workspace" {
    bindsym Super_L mode "default"

    bindsym Ctrl+Shift+h move workspace to output left; mode "default"
    bindsym Ctrl+Shift+j move workspace to output down; mode "default"
    bindsym Ctrl+Shift+k move workspace to output up; mode "default"
    bindsym Ctrl+Shift+l move workspace to output right; mode "default"
}

## ----- ##
## rules ##

for_window [urgent=latest] focus
for_window [window_role="pop-up"] floating enable

assign [title="Slack"] 1
assign [title="Google Chrome"] 2
assign [title="Mozilla Firefox"] 2
assign [title="Thunderbird"] 4
assign [title="Keybase"] 8
